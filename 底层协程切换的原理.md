# 底层协程切换的原理

协程切换是协程调度的关键，他将一个协程的状态保存并切换到另一个协程中继续执行

## 线程

一般而言，线程具有以下四个要素：
* 执行代码
* 栈
* 堆
* 寄存器

如果我们想要实现一个用户级的线程，即协程，每个协程就需要独立的以上四个属性。其中执行代码由寄存器eip保存。一些数据虽然是在堆中分配的，但他也是借助栈上分配的指针等间接保存的。而栈是由ebp和esp寄存器所保存，所以决定一个协程的要素被简化为寄存器。

## 寄存器（以x86 64位为例）

